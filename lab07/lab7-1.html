<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>방문 카운트 쿠키</title>
	<script>
		function GetCookie(name) {
			let pairs = document.cookie.split(";"); // 쿠키문자열을 ;을 경계로 분할
			for (let i = 0; i < pairs.length; i++) {
				let pair = pairs[i].trim(); // 쿠키 앞뒤의 빈칸 제거
				let unit = pair.split("=");
				if (unit[0] == name)
					return unescape(unit[1]);
			}
			return null;
		}
		function SetCookie(name, value, expireDate) {
			let cookieStr = name + "=" + escape(value) +
				((expireDate == null) ? "" : ("; expires=" + expireDate.toUTCString()));
			document.cookie = cookieStr;
		}
	</script>
	<style>
		.popup {
			position: fixed;
			width: 250px;
			height: 200px;
			z-index: 100;
			box-shadow: 1px 1px 5px 1px #000;
			display: block;
			top: 200px;
			left: 200px;
			background-color: antiquewhite;
			text-align: center;
		}

		.btn {
			margin-top: 50px;
		}

		img {
			width: 100%;
			height: 100%;
		}
	</style>
</head>

<body>
	<h1>쿠키 테스트 하기</h1>
	<hr>
	<div>본문 내용 영역</div>
	<div class="popup">
		<div class="popup_contents">
			<h3>Notice</h3>
			<p>팝업인 척 하는 div 태그<br>
				이모저모 공지사항 어쩌구</p>
		</div>
		<div class="btn">
			<button onclick="hidePopup()">오늘 하루 보지 않기</button>
			<button onclick="closePopup()">Close</button>
		</div>
	</div>
	<script>
		let username = GetCookie("username");
		let count = GetCookie("count");

		let today = GetCookie("today"); // 오늘 하루 보지 않기 기능: 오늘 방문한 적이 있는지 확인
		if (today == "y") {
			document.querySelector(".popup").style.display = "none";
		}

		let expire = new Date(); // 현재 시간
		expire.setTime(expire.getTime() + (1 * 24 * 3600 * 1000)); // 오늘 하루 보지 않기 기능: 쿠키 만료 시간 추가 (1일후)

		if (username == null) {
			count = 0;
			username = prompt("이름을 입력해 주십시오.", "");
			if (username == null) {
				alert("이름을 입력하시면 보다 나은 서비스를 제공받을 수 있습니다.");
				username = "아무개";
			} else {
				expire.setTime(expire.getTime() + (365 * 24 * 3600 * 1000)); // 1년후 
				SetCookie("username", username, expire);
			}
		}
		count++;
		expire.setTime(expire.getTime() + (365 * 24 * 3600 * 1000)); // 1년후 
		SetCookie("count", count, expire);
		document.write("<p>어서오십시오. " + username + "님의 " + count + "번째 방문을 환영합니다!");

		// 오늘 하루 보지 않기 기능 실행용 함수 작성
		function hidePopup() {
			let expire = new Date();
			expire.setTime(expire.getTime() + (1 * 24 * 3600 * 1000)); // 1일후
			SetCookie("today", "y", expire);
			document.querySelector(".popup").style.display = "none";
		}

		// 팝업창 닫기 기능 실행용 함수 작성
		function closePopup() {
			document.querySelector(".popup").style.display = "none";
		}

		// 오늘 하루 보지 않기 기능 실행
	</script>
</body>

</html>